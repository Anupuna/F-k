INTERNSHIP REPORT
About Bosch:
Bosch is a leading supplier of mobility solutions, Industrial technology, Consumer Goods and Energy and Building technologies in India. Bosch provides cutting edge technologies in mobility solutions and services also. The lion's share of RB's business is in the automotive domain. Apart from this, they also have products in the retail/consumer segment, power tools, home automation and so forth.
Targeting the automotive domain, there are many teams, addressing clients around the world, working on different objectives. These teams work on diverse fields of interest. These include:
•	Engine Management systems
•	Powertrain engineering
•	Electronic stability systems
•	Vehicle functions
•	Vehicle Safety systems
•	Vehicle Brake systems
•	ECU monitoring systems
•	Customer engineering 
About RBEI:
Robert Bosch Engineering and Business Solutions Private Limited is a 100% owned subsidiary of Robert Bosch GmbH, one of the world’s leading global supplier of technology and services, offering end to end engineering, IT and Business solutions. Automotive, healthcare, agriculture and aerospace are some of the domains in which REBI works.
Robert Bosch Engineering and Business Solutions Limited (RBEI), is a 100% owned subsidiary of Robert Bosch GmbH, one of the world’s leading global supplier of technology and services, offering end to end engineering, IT and Business solutions. With more than 19000+ associates, it is the largest software development center of Bosch, outside Germany, indicating it is the technology flagship of Bosch in India with a global footprint and presence in US, Europe and the Asia Pacific region. It is ISO 9001:2008 certified (2009), appraised at CMMI-L5 (2006) and also ISO 27001 certified (2009). It has three state-of-the-art facilities in Bangalore, Coimbatore and a third development center in Hyderabad. It nurtures, builds and sustains enduring customer relationships to enable direct operational and strategic benefits to its customers. This is achieved through qualified, motivated and flexible professional associates, who uphold the heritage and values of Bosch - time-tested over 124 years of a successful journey; a journey marked by quality, reliability and innovation of service to enhance the interest of its customers and the community we live in.
About Vehicle function team:
EPJ- Vehicle function team focusses on Vehicle function development for all JOEMs, function and software development in safety and monitoring functions for JOEM and KOEMs, Communication function development for Isuzu and hold CE responsibilities for CV/OHW customers for power train applications, with DGS-EC/ECO-JP, DGS-EC/EEM-JP and DGS-EC/EFC as our main contact partners. Key focus areas are:
•	Support DGS-EC/EFC in the area of ECU monitoring functions for Diesel and Gasoline systems 
•	Compliance to ISO 26262 and ASPICE safety critical development process 
•	Vehicle function development for Honda, Toyota, Daihatsu and other CV/OHW customers 
•	Communication function development for Isuzu 
•	CE responsibilities for CV/OHW customers, mainly Isuzu, MFTBC, MHI, Kubota, Yanmar
•	Powertrain and its devices
•	Driver Assistance
•	Electrical supply systems and devices
•	Thermal systems and devices 
Powertrain: Powertrain system provides the driving force behind the mobility which vehicles have provided in all the commercial activities around the globe. Powertrain describes the main components that generate power and deliver it to the road surface, water or air. This includes the engine, transmission, drive shafts, differentials and final drive (drive wheels, continuous track as in military tanks or caterpillar tractors, propellers etc.). A motor vehicle's driveline or drivetrain consists of the parts of the powertrain excluding engine and transmission. The most recent developments in powertrain are driven by the electrification of it in multiple components. Electrical engines can be found as isolated component or as part of other elements, e.g. the axle. In hybrid powertrains the torque generated by the combustion engine and the electric motor have to be brought together and distributed to the wheels. The control of this process can be quite involved but the rewards are greatly improved acceleration and much lower emissions.
The work of vehicle function team in area of powertrain mainly includes co-ordination of engine torque and gear box torque, torque loss calculation, thermal requirements of the drive train, checking of ignition status and information on type of transmission used in powertrain. It also works on powertrain devices such as clutch status, determination of gear box neutral gear position from PWM signal or digital switch senor or through CAN, debounce signal checks, determination of driving modes (like parking or reverse or neutral) and starter motor diagnostics.
 
Figure 1: Conventional Powertrain

 
Figure 2: Powertrain of hybrid vehicle
Driver Assistance: Driver assistance, also known as advanced driver-assistance systems (ADAS), are technologies used to make motor vehicle travel safer by automating, improving or adapting some or all of the tasks involved in operating a vehicle. Driver assistance serves to make travel comfortable and easier, while also increasing car and road safety. While some systems help with the task of driving, others alert the driver to errors or hazards, such as lane departure detection and drowsiness detection. Aside from vehicle control, driver assistance can also refer to secondary driving tasks such as location finding, route planning and obstacle detection. Driver assistance involves both simple systems such as anti-lock braking and complex systems like the fully autonomous hardware and software operating a driverless car. More complex systems that take control of the car include technologies such as machine vision, artificial intelligence (AI), radar, lasers and various position-detecting technologies.
 
Figure 3: Driver assistance systems
Examples of driver assistance systems include:
•	Drowsiness detection
•	Lane departure detection
•	Cruise control
•	Adaptive cruise control
•	Anti-lock braking systems
•	Global Positioning System (GPS)
•	Accident prevention systems
•	Blind spot detection
•	Intelligent speed control
The work of team in area of driver assistance mainly incudes cruise control, adaptive cruise control, intelligent speed control. Cruise control is a system that automatically controls the speed of a motor vehicle. The system is a servomechanism system that takes over the throttle of the car to maintain a steady speed as set by the driver and allows the driver to take hi/he foot off the accelerator pedal.  Adaptive cruise control is an improvement done to cruise control where the speed of the vehicle is adjusted to maintain a safe distance from vehicles ahead.

Electrical supply systems and devices: The electrical system of a car comprises of many components. They include generators to electric wiring harness to connectors and many more. Over the period of time, the electrical system got updates, upgrades, and additions. This is mainly because the number of components operating on electric power and therefore, the power consumption increased substantially. The main function of the electrical system is to generate, store and supply the electric current to various systems in the vehicle. It operates the electrical components/parts in vehicles. These components include several electrical gauges, digital gadgets, power windows, central locking mechanisms and many more.
Most components of the earlier generation vehicles were predominantly mechanical in nature and operation. Over the period of time, these components started operating electrically/electronically; shedding their pure mechanical function which the earlier generation vehicles used. Nowadays, the majority of vehicular systems have an electric function for ease of operation and precision control. Even more advanced steering systems such as Electric Power Assisted Steering (EPAS) also operate by electric power. Hence, the engineers felt the need for a consistency in the generation of the electric power. So, they employed different mechanisms to effectively generate, regulate, store and supply the electric current in the vehicles.
The electrical system of a car consists of following main components:
1.	Starter: Located on the back of the engine or the front of the transmission, the starter cranks the engine when the ignition switch is turned on. It’s recommended to have the starter tested to make sure it is drawing the correct amount of current every spring.
 
Figure 4: Audi VW Starter and Bosch alternator

2.	Alternator: The alternator is the car’s electrical charger. Its various parts are contained in an aluminum housing and generate direct current for recharging the vehicle’s battery. The vehicle’s alternator also helps to power the other electrical loads of car. It’s recommended to have the alternator’s drive belt checked at every oil change. A loose alternator belt can reduce alternator output and run down your battery.

3.	Battery: The battery is the backbone of the vehicle’s electrical system as it supplies power to the starter and ignition system. The vehicle’s battery also delivers the extra power needed when the electrical load exceeds the alternator’s supply. There are different types of batteries such as AGM (Absorbed Glass Mat) battery, lithium ion battery, deep cycle battery, etc.

Some of other electrical devices include:
•	Power windows 
•	Power steering 
•	Headlights and other exterior lights 
•	Windshield wipers, etc.


 
Figure 5: AGM and Lead acid battery
The work of team in area of electrical supply systems and devices, mainly includes calculation of alternator set point voltage, calculation of amount of charge required by the battery, energy management (proper battery condition and alternator power generation) and coordination of minimum supply voltage in case of Intelligent Generator Control (IGC).
Thermal systems and devices: Automotive thermal system is concern with the management of liquid, temperature and air. It increases the comfort of the passengers by taking care of the temperature inside the vehicle. The main components of automotive thermal system are: 
•	Powertrain cooling
•	Air conditioner (AC)
•	Radiator
•	Battery thermal management
•	Power device cooling 
•	Waste heat recovery.

The work of team in area of thermal systems and devices mainly include air conditioner coolant pressure sensor which includes acquisition of AC coolant temperature sensor value from ADC or PWM or digital signal, error handling and evaluation of AC coolant pressure, air conditioner compressor output. It also works on additional water heater device, coolant thermostat actuator device, coordination of thermal system demands such as total torque calculation of thermal components.

 
Figure 6: Automotive Thermal management system

 
Background knowledge required for the task:
1.	Electronic Control Unit (ECU)
What is an ECU and why it is required: An Electronic Control Unit (ECU) is any embedded system responsible for overseeing, regulating and altering the operation of a car's electronic systems. It is a computer with internal pre-programmed and programmable computer chips that is not much different from a home computer or laptop. An engine control unit (ECU), also commonly called an engine control module (ECM), is a type of electronic control unit that controls a series of actuators on an internal combustion engine to ensure optimal engine performance. It does this by reading values from a multitude of sensors within the engine bay, interpreting the data using multidimensional performance maps (called lookup tables), and adjusting the engine actuators like fuel injector and spark plug . There are different ECUs used for the transmission, traction control or ABS, AC, body functions and lighting control, engine, air bags, or any other system of a vehicle. Some vehicles may incorporate more than one ECU into a single unit called a powertrain control module (PCM). These units can be an advantage by having more modules in one location but may be a disadvantage by adding longer wires to reach the component it operates. 
Most of the vehicles have started using a communication line between different modules on a vehicle so they can share information and redundant sensors do not have to be used. For instance, a speed sensor at a wheel detects the wheel speed and will be an input to the anti-lock brake module (ABS) ECU. Instead of sending many wires from the one sensor to other ECUs, the ABS ECU will share the information on the network communication lines to all the ECUs that use the information, like a transmission for its shifting of gears, the speedometer to show the speed of the vehicle, or the suspension system to control the suspension as needed. 
How do electronic control units work?
On a very basic level, an ECU is an electronic device fed with several inputs. The data from these inputs is assessed by the ECU and compared against stored on-board data. The ECU then decides what needs to happen to ensure the system in question functions properly and issues new commands to suit. These outputs then alter the operation of the system, delivering the desired effect.
For example, modern electronic fuel injection systems are controlled by ECUs. Data, including temperature, engine speed and accelerator position is fed into the ECU. The ECU then compares the data against on-board tables that tell it what the engine ideally needs, and alters the behavior of the fuel injectors - and in many cases the ignition system - to deliver the best performance.
 
Figure 7: Inside view of ECU
Common types of ECU:
Engine control module: Also known as an engine control unit. Responsible for assessing the load of the engine and tuning the ignition, fuel delivery and more to deliver optimum performance and economy.
Transmission control module: These control the way, and when, an automatic gearbox shifts. Besides being fed with sensor data from the transmission itself, TCMs may also take data from the engine control unit to deliver more suitable, precise shifts.
Suspension control module: Sometimes dubbed a ride control module and common in active, adjustable or air suspension set-ups. These adjust the suspension to suit the current driving conditions, or work to maintain the correct ride height.
Body control module: This unit is typically responsible for controlling the car's myriad electrical access, comforts and security features. Common features it controls include door locks, electric windows and climate systems.
Telematics control module: Typically offers internet and phone connectivity for the car's on-board services. May also include a GPS receiver for navigation services.

 
Figure 8: ECUs in typical modern car

2.	Cruise Control
What is Cruise Control and why it is required: Cruise control (sometimes known as speed control or auto cruise) is a system that automatically controls the speed of a motor vehicle. The system accurately maintain a speed set by the driver without any outside intervention by controlling the throttle-accelerator pedal linkage. Cruise control is an invaluable feature in modern ­cars. Without it, long road trips would be far more tiring, at least for the driver. It’s far more common to find cruise control on American cars than European or Asian ones, as the roads in America are generally bigger and straighter, and destinations are much farther apart. 
Working of Cruise Control system: The cruise control system controls the speed of the car by adjusting the throttle (accelerator) position. However, cruise control engages the throttle valve by a cable connected to an actuator, rather than by pressing a pedal. The throttle valve controls the power and speed of the engine by limiting how much air it takes in (since it’s an internal combustion engine). 
 
Figure 9: Block diagram showing inputs and outputs of a typical cruise control system

The driver can set the cruise control with the cruise switches, which usually consist of ON, OFF, RESUME, SET/ACCEL and COAST. These are commonly located on the steering wheel or on the windshield wiper or turn signal stalk. The SET/ACCEL knob sets the speed of the car. One tap will accelerate it by 1 mph, two by 2 mph and so on. Tapping the knob in the opposite direction will decelerate the vehicle. As a safety feature, the cruise control system will disengage as soon as you hit the brake pedal.
Advantages and Disadvantages:
Some advantages of cruise control are: 
•	Its usefulness for long drives (reducing driver fatigue, improving comfort by allowing positioning changes more safely) across highways and sparsely populated roads. 
•	Some drivers use it to avoid subconsciously violating speed limits. A driver who otherwise tends to subconsciously increase speed over the course of a highway journey may avoid speeding.
•	Increased fuel efficiency.
However, when used incorrectly cruise control can lead to accidents due to several factors, such as: 
•	Speeding around curves that require slowing down.
•	Rough or loose terrain that could negatively affect the cruise control controls.
•	Rainy or wet weather could lose traction.
•	Encourages drivers to pay less attention to driving, increasing the risk of an accident.
3.	Adaptive Cruise Control (ACC)
Adaptive cruise control is similar to conventional cruise control in that it maintains the vehicle's pre-set speed. However, unlike conventional cruise control, this new system can automatically adjust speed in order to maintain a proper distance between vehicles in the same lane. This is achieved through a radar headway sensor, digital signal processor and longitudinal controller. If the lead vehicle slows down, or if another object is detected, the system sends a signal to the engine or braking system to decelerate. Then, when the road is clear, the system will re-accelerate the vehicle back to the set speed.
ACC technology is widely regarded as a key component of any future generations of intelligent cars. They impact driver safety and convenience as well as increasing capacity of roads by maintaining optimal separation between vehicles and reducing driver errors. Vehicles with autonomous cruise control are considered a Level 1 autonomous car, as defined by SAE International.[2] When combined with another driver assist feature such lane centering then the vehicle is considered a Level 2 autonomous car.
Working of ACC:
 
Figure 10: The drivers view in ACC
The driver sets a maximum speed similar to what one would do with normal cruise control. A radar sensor located in the front end of the car locates traffic ahead of it and locks on to the car ahead. This sensor then controls the speed of your car so that it always stays 2-3 seconds behind the car in front.  
Using the input from the radar sensors, the computer unit measures the distance of the car ahead and calculates the speed relative to it. If there are multiple vehicles in the sensor’s field of coverage at the same time, it automatically selects which of the vehicles the system should track.
For instance, if you’re approaching a slower vehicle ahead or if another vehicle cuts in front of you, the adaptive cruise control slows down the car by initiating corrective controls in the engine management and, if necessary, in the braking system as well.
ACC is very conscientious when it comes to safety.  If you’re driving too close to the car in front, it will warn you in two stages. First, it will alert you with visual and acoustic signals, and then with a short braking jolt. If necessary, the system will bring your car to a complete stop. Some units employ a laser, while others use an optical system based on stereoscopic cameras. Regardless of the technology, ACC works day or night, but its abilities can be hampered by extreme conditions, such as heavy rain, fog, or snow.
 
Figure 11: Collision warning and brake support in ACC

Advantages:
•	The driver is relieved from the task of careful acceleration, deceleration and braking congested traffics.
•	A highly responsive traffic system that adjusts itself to avoid accidents can be developed.
•	Since the braking and acceleration are done in systematic way, the fuel efficiency of the vehicle is increased.
Disadvantages:
•	A low cost version is not yet realized.
•	A high market penetration is required if a society of intelligent vehicles is to be formed.
•	Encourages the driver to become careless. It can lead to severe accidents if system malfunctions.


Name of the task: Requirement of design change in FC:CrCUI_GetUI
Importance of the change: The state of cruise control is reset when engine state error occurs i.e Engine state MIL (Mal-function Indicator Lamp) is switched on.
Tools used for implementation: ASCET V6.1
Tools used for testing: TPT_8.0u2
Workflow followed for the task:
 


DoU:
Changes to be done: Block of design to be added to reset Cruise control state to off when Engine MIL is turned on.
Importance: MIL is switched on if there is problem with vehicle’s engine, transmission or emission control system. So if the Engine MIL is on when the cruise is active then the cruise should be reset to avoid any incidents of accident or damages to engine. 
 
Figure 12: Engine MIL
Conditions for resetting of Cruise control state:
i.	Ignition is off (T15 off).
ii.	If Fid to cancel cruise is set (DINH_stFId_CrCtlEMSError=0)
iii.	If Engine MIL is turned ON.

Design:
Base FC version: FC:CrCUI_GetUI 29.11.0
Base BC version: BC:DrAs 24.23.0_3.5.0
PVER details: PVER: ME17953C0Y20MEB/C140S0; 0
Calibrations added: CRCUI_stEngMILShOff_C (Local)
		         UNIT & RANGE:  UBYTE [0.0 ... 255.0]
Variables Added: ErrLmp_stMIL (Imported)
		         UNIT & RANGE:  UBYTE [0.0 ... 255.0]
Constant added: CRCUI_ZERO
The design and implementation of the task was done using ASCET V6.1 tool.
About ASCET: ASCET (Advanced Simulation and Control Engineering Tool) V6.1 is a tool for developing application software for embedded systems using graphical models and textual programming notations. It’s a product of ETAS (Engineering Tools, Application and Services) Group. It is primarily used by software developers of automotive manufacturers and their suppliers to develop embedded for control functions and algorithms for ECU. ASCET V6.1 Code Generator translates function models into highly efficient and safe embedded C-Code for AUTOSAR and non-AUTOSAR applications. The main advantage of using this tool is that it follows model based design approach for developing embedded systems.

 
Figure 13: Implemented design

The code, which included all the header files and the needed functionalities, was generated in ASCET after implementation, using Code generator.
Testing the change:
The implemented design was tested using TPT_8.0u2.
About TPT (Time Partition Testing): It’s a model-based testing tool, mainly used in the automotive controller development, originally developed by Daimler AG. It combines the systematic and graphic modelling techniques for test cases with a fully automated test execution in different environment. The test document generated is as per the IEEE 829 format. FUSION platform was used to test the different test cases.


Test Results:
Test case 1: When T15 is switched OFF.
 
Test case 2: When ErrLmp_stMIL is turned ON.
 
Test case 3: When Fid to cancel cruise is set (i.e DINH_stFId_CrCtlEMSError=0)
 
Test case 4: When both ErrLmp and Fid to cruise are set.
 
Take away from the task: 
•	Gained exposure to the procedure that has to be followed to complete a task. Understood the importance of documentations and the DoU that has to be addressed before taking up the actual implementation of the task.
•	Understood the importance of electronics for optimum functionality of the car.
•	Gained brief knowledge about the various functionalities that involve the usage of the ECU in a vehicle.
o	Of these, this task mainly focused on Cruise Control and Adaptive Cruise Control. 
o	Understood the pros and cons of cruise control in a car.
	Pros: Efficient fuel management and reduces driver strain.
	Cons: Inefficient fuel management in high density traffic area. 

•	Introduction to and learning of new tools like ASCET, TPT.
o	ASCET: It is a tool used for model-based development of embedded automotive software.
o	TPT:  It is a tool used for functional testing of embedded software.
•	Understanding of working in SDOM.
o	SDOM is server domain where all the project related data is stored and accessed using Bosch Cloud Workspace.
•	Uploading the design files to SDOM and document generation.
•	Generating of DLL file for testing using hex and a2l files using ECUWorx.
o	DLL (Dynamic Link Library): It is file that contains code and data that can be used by more than one program at the same time.
o	Hex file: It is file that contains settings, configuration information or other data in hexadecimal format used for programming microcontrollers.
o	 A2l file: It contains details of all the parameters and variables used for implantation of ECU.
•	Creating of test plan (test cases) and testing of the change done using TPT.

